<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Smoke Signals</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #c9a676 0%, #a67c52 100%);
            color: #4a3728;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .screen {
            display: none;
            text-align: center;
            width: 100%;
            max-width: 400px;
        }

        .screen.active {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        h1 {
            font-size: 2.5em;
            color: #6b4423;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        h2 {
            font-size: 1.8em;
            color: #6b4423;
            margin-bottom: 15px;
        }

        p {
            font-size: 1.1em;
            line-height: 1.6;
            color: #5a4030;
            margin-bottom: 20px;
        }

        button {
            background: #8b6f47;
            color: #f5e6d3;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            font-family: 'Georgia', serif;
            margin: 10px;
        }

        button:active {
            transform: scale(0.95);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        #animation-container {
            width: 100%;
            height: 350px;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            margin-bottom: 30px;
            position: relative;
            background: linear-gradient(to bottom, 
                #87ceeb 0%,
                #b8956a 60%,
                #8b6f47 100%);
            border-radius: 15px;
            overflow: hidden;
        }

        .scene {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 30px;
        }

        .mountain {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 100px solid transparent;
            border-right: 100px solid transparent;
            border-bottom: 140px solid #7d6850;
            filter: drop-shadow(0 -5px 10px rgba(0,0,0,0.2));
            z-index: 3;
        }

        .mountain::before {
            content: '';
            position: absolute;
            bottom: -140px;
            left: -120px;
            width: 0;
            height: 0;
            border-left: 120px solid transparent;
            border-right: 120px solid transparent;
            border-bottom: 100px solid #6b5a46;
        }

        .mountain::after {
            content: '';
            position: absolute;
            bottom: -140px;
            right: -120px;
            width: 0;
            height: 0;
            border-left: 120px solid transparent;
            border-right: 120px solid transparent;
            border-bottom: 100px solid #6b5a46;
        }

        .campfire {
            position: absolute;
            bottom: 220px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 80px;
            z-index: 5;
        }

        .fire {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 50px;
        }

        .flame {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 35px;
            background: linear-gradient(to top, 
                #ff4500 0%,
                #ff6347 30%,
                #ffa500 60%,
                #ffff00 90%,
                rgba(255, 255, 255, 0.8) 100%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: flame-flicker 0.3s infinite alternate;
            filter: blur(1px);
        }

        .flame::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: -10px;
            width: 18px;
            height: 28px;
            background: linear-gradient(to top, 
                #ff6347 0%,
                #ffa500 50%,
                rgba(255, 215, 0, 0.6) 100%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: flame-flicker 0.4s infinite alternate-reverse;
            filter: blur(1px);
        }

        .flame::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: -10px;
            width: 18px;
            height: 30px;
            background: linear-gradient(to top, 
                #ff6347 0%,
                #ffa500 50%,
                rgba(255, 215, 0, 0.6) 100%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: flame-flicker 0.35s infinite alternate;
            filter: blur(1px);
        }

        .inner-flame {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 20px;
            background: linear-gradient(to top, 
                #ff8c00 0%,
                #ffff00 50%,
                rgba(255, 255, 255, 0.9) 100%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: inner-flicker 0.25s infinite alternate;
            filter: blur(0.5px);
        }

        .fire-glow {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, 
                rgba(255, 140, 0, 0.6) 0%,
                rgba(255, 69, 0, 0.3) 40%,
                transparent 70%);
            border-radius: 50%;
            animation: glow-pulse 0.5s infinite alternate;
            filter: blur(10px);
        }

        @keyframes flame-flicker {
            0% { 
                transform: translateX(-50%) scaleY(1) scaleX(1);
                opacity: 0.95;
            }
            100% { 
                transform: translateX(-50%) scaleY(1.08) scaleX(0.95);
                opacity: 1;
            }
        }

        @keyframes inner-flicker {
            0% { 
                transform: translateX(-50%) scaleY(1);
                opacity: 0.9;
            }
            100% { 
                transform: translateX(-50%) scaleY(1.15);
                opacity: 1;
            }
        }

        @keyframes glow-pulse {
            0% { 
                transform: translateX(-50%) scale(1);
                opacity: 0.6;
            }
            100% { 
                transform: translateX(-50%) scale(1.1);
                opacity: 0.8;
            }
        }

        .embers {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 50px;
        }

        .ember {
            position: absolute;
            width: 3px;
            height: 3px;
            background: #ff6347;
            border-radius: 50%;
            box-shadow: 0 0 4px #ff4500;
            animation: ember-rise 2s infinite ease-out;
        }

        .ember:nth-child(1) {
            left: 20%;
            animation-delay: 0s;
        }

        .ember:nth-child(2) {
            left: 50%;
            animation-delay: 0.5s;
        }

        .ember:nth-child(3) {
            left: 70%;
            animation-delay: 1s;
        }

        @keyframes ember-rise {
            0% {
                bottom: 15px;
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                bottom: 60px;
                opacity: 0;
                transform: translateY(-20px) translateX(10px);
            }
        }

        .figure {
            position: absolute;
            bottom: 220px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 60px;
            z-index: 4;
        }

        .head {
            width: 18px;
            height: 18px;
            background: #5a4a3a;
            border-radius: 50%;
            margin: 0 auto 2px;
            box-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }

        .body {
            width: 25px;
            height: 30px;
            background: #6d5a46;
            margin: 0 auto;
            border-radius: 4px;
            box-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }

        .legs {
            width: 28px;
            height: 15px;
            margin: 0 auto;
            display: flex;
            justify-content: space-around;
            padding-top: 2px;
        }

        .leg {
            width: 8px;
            height: 15px;
            background: #5a4a3a;
            border-radius: 4px;
            box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .smoke {
            position: absolute;
            width: 80px;
            height: 100px;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            pointer-events: none;
        }

        .smoke-puff {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, 
                rgba(240, 235, 230, 0.9) 0%,
                rgba(220, 215, 210, 0.7) 20%,
                rgba(200, 195, 190, 0.5) 50%,
                rgba(180, 175, 170, 0.2) 80%,
                transparent 100%);
            animation: smoke-rise-puff 3.75s ease-out forwards;
            filter: blur(3px);
        }

        .smoke-puff:nth-child(1) {
            width: 50px;
            height: 50px;
            left: 15px;
            animation-delay: 0s;
        }

        .smoke-puff:nth-child(2) {
            width: 60px;
            height: 60px;
            left: 10px;
            animation-delay: 0.3s;
        }

        .smoke-puff:nth-child(3) {
            width: 70px;
            height: 70px;
            left: 5px;
            animation-delay: 0.6s;
        }

        .smoke-puff:nth-child(4) {
            width: 55px;
            height: 55px;
            left: 12px;
            animation-delay: 0.9s;
        }

        .smoke-puff:nth-child(5) {
            width: 65px;
            height: 65px;
            left: 8px;
            animation-delay: 1.2s;
        }

        @keyframes smoke-rise-puff {
            0% {
                bottom: 0;
                opacity: 0;
                transform: translateY(0) scale(0.3) rotate(0deg);
            }
            10% {
                opacity: 0.8;
            }
            50% {
                opacity: 0.6;
            }
            100% {
                bottom: 200px;
                opacity: 0;
                transform: translateY(-50px) scale(1.8) rotate(45deg);
            }
        }

        .smoke-wisp {
            position: absolute;
            width: 3px;
            height: 20px;
            background: linear-gradient(to top, 
                rgba(200, 195, 190, 0.4),
                transparent);
            filter: blur(2px);
            animation: wisp-rise 2s ease-out forwards;
        }

        .smoke-wisp:nth-child(6) {
            left: 30px;
            animation-delay: 0.2s;
        }

        .smoke-wisp:nth-child(7) {
            left: 45px;
            animation-delay: 0.5s;
        }

        @keyframes wisp-rise {
            0% {
                bottom: 0;
                opacity: 0.6;
            }
            100% {
                bottom: 150px;
                opacity: 0;
                transform: translateX(15px);
            }
        }

        .eagle {
            position: absolute;
            top: 40px;
            right: 60px;
            width: 50px;
            height: 40px;
            z-index: 2;
        }

        .eagle.fly-intro {
            animation: eagle-glide 8s ease-in-out infinite;
        }

        .eagle.fly-right {
            animation: eagle-glide-right 3s ease-in-out forwards;
        }

        .eagle.fly-left {
            animation: eagle-glide-left 3s ease-in-out forwards;
            transform: scaleX(-1);
        }

        .eagle.fly-circle {
            animation: eagle-circle 3s ease-in-out forwards;
        }

        .eagle.fly-zigzag {
            animation: eagle-zigzag 3s ease-in-out forwards;
        }

        .eagle.fly-dive {
            animation: eagle-dive 3s ease-in-out forwards;
        }

        .eagle.fly-swoop {
            animation: eagle-swoop 3s ease-in-out forwards;
        }

        .eagle.fly-spiral {
            animation: eagle-spiral 3s ease-in-out forwards;
        }

        .eagle.fly-wave {
            animation: eagle-wave 3s ease-in-out forwards;
        }

        .eagle.fly-figure8 {
            animation: eagle-figure8 3s ease-in-out forwards;
        }

        .eagle-body {
            position: absolute;
            width: 14px;
            height: 20px;
            background: linear-gradient(135deg, #4a3728 0%, #3a2818 100%);
            border-radius: 40% 40% 50% 50%;
            left: 50%;
            transform: translateX(-50%);
            top: 8px;
        }

        .eagle-head {
            position: absolute;
            width: 10px;
            height: 10px;
            background: radial-gradient(circle at 40% 40%, #5a4a3a, #3a2818);
            border-radius: 50%;
            left: 50%;
            transform: translateX(-50%);
            top: 0;
        }

        .eagle-beak {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 4px solid transparent;
            border-right: 0px solid transparent;
            border-top: 4px solid #d4a574;
            left: 8px;
            top: 5px;
        }

        .eagle-wing {
            position: absolute;
            width: 25px;
            height: 12px;
            background: linear-gradient(90deg, 
                #4a3728 0%,
                #5a4a3a 40%,
                transparent 100%);
            border-radius: 60% 20% 80% 20%;
            top: 12px;
            transform-origin: right center;
        }

        .eagle-wing.left {
            left: -12px;
            animation: wing-flap 1.5s ease-in-out infinite;
        }

        .eagle-wing.right {
            right: -12px;
            transform: scaleX(-1);
            animation: wing-flap 1.5s ease-in-out infinite;
            animation-delay: 0.1s;
        }

        @keyframes eagle-glide {
            0% {
                right: 60px;
                top: 40px;
            }
            50% {
                right: 250px;
                top: 60px;
            }
            100% {
                right: 60px;
                top: 40px;
            }
        }

        @keyframes eagle-glide-right {
            0% {
                right: -60px;
                top: 40px;
            }
            100% {
                right: 100%;
                top: 50px;
            }
        }

        @keyframes eagle-glide-left {
            0% {
                left: -60px;
                top: 40px;
            }
            100% {
                left: 100%;
                top: 50px;
            }
        }

        @keyframes eagle-circle {
            0% {
                right: 50%;
                top: 30px;
                transform: rotate(0deg) translateX(60px);
            }
            25% {
                transform: rotate(90deg) translateX(60px);
            }
            50% {
                transform: rotate(180deg) translateX(60px);
            }
            75% {
                transform: rotate(270deg) translateX(60px);
            }
            100% {
                right: 50%;
                top: 30px;
                transform: rotate(360deg) translateX(60px);
            }
        }

        @keyframes eagle-zigzag {
            0% {
                right: 100%;
                top: 30px;
            }
            20% {
                right: 75%;
                top: 60px;
            }
            40% {
                right: 50%;
                top: 35px;
            }
            60% {
                right: 30%;
                top: 65px;
            }
            80% {
                right: 10%;
                top: 40px;
            }
            100% {
                right: -60px;
                top: 55px;
            }
        }

        @keyframes eagle-dive {
            0% {
                right: 20%;
                top: 20px;
            }
            50% {
                right: 50%;
                top: 150px;
            }
            100% {
                right: 80%;
                top: 30px;
            }
        }

        @keyframes eagle-swoop {
            0% {
                right: 80%;
                top: 45px;
            }
            30% {
                right: 60%;
                top: 25px;
            }
            70% {
                right: 30%;
                top: 70px;
            }
            100% {
                right: 10%;
                top: 40px;
            }
        }

        @keyframes eagle-spiral {
            0% {
                right: 50%;
                top: 20px;
                transform: rotate(0deg) scale(1);
            }
            25% {
                right: 40%;
                top: 35px;
                transform: rotate(90deg) scale(0.8);
            }
            50% {
                right: 50%;
                top: 50px;
                transform: rotate(180deg) scale(0.6);
            }
            75% {
                right: 60%;
                top: 35px;
                transform: rotate(270deg) scale(0.8);
            }
            100% {
                right: 50%;
                top: 20px;
                transform: rotate(360deg) scale(1);
            }
        }

        @keyframes eagle-wave {
            0% {
                right: 100%;
                top: 50px;
            }
            16.66% {
                right: 83%;
                top: 30px;
            }
            33.33% {
                right: 66%;
                top: 60px;
            }
            50% {
                right: 50%;
                top: 35px;
            }
            66.66% {
                right: 33%;
                top: 65px;
            }
            83.33% {
                right: 16%;
                top: 40px;
            }
            100% {
                right: -60px;
                top: 55px;
            }
        }

        @keyframes eagle-figure8 {
            0% {
                right: 50%;
                top: 40px;
                transform: translate(0, 0);
            }
            12.5% {
                right: 40%;
                top: 30px;
                transform: translate(-20px, -10px);
            }
            25% {
                right: 50%;
                top: 40px;
                transform: translate(0, 0) rotate(90deg);
            }
            37.5% {
                right: 60%;
                top: 50px;
                transform: translate(20px, 10px);
            }
            50% {
                right: 50%;
                top: 40px;
                transform: translate(0, 0) rotate(180deg);
            }
            62.5% {
                right: 40%;
                top: 50px;
                transform: translate(-20px, 10px);
            }
            75% {
                right: 50%;
                top: 40px;
                transform: translate(0, 0) rotate(270deg);
            }
            87.5% {
                right: 60%;
                top: 30px;
                transform: translate(20px, -10px);
            }
            100% {
                right: 50%;
                top: 40px;
                transform: translate(0, 0) rotate(360deg);
            }
        }

        @keyframes wing-flap {
            0%, 100% {
                transform: rotate(-8deg);
            }
            50% {
                transform: rotate(8deg);
            }
        }

        .cactus {
            position: absolute;
            bottom: 20px;
            left: 30px;
            width: 40px;
            height: 100px;
            z-index: 10;
        }

        .cactus-main {
            position: absolute;
            width: 18px;
            height: 80px;
            background: linear-gradient(to right,
                #5a7c4f 0%,
                #6d8f61 50%,
                #5a7c4f 100%);
            border-radius: 15px;
            left: 50%;
            transform: translateX(-50%);
            bottom: 0;
            box-shadow: inset -2px 0 5px rgba(0,0,0,0.3),
                        inset 2px 0 5px rgba(255,255,255,0.1);
        }

        .cactus-arm {
            position: absolute;
            width: 14px;
            background: linear-gradient(to right,
                #5a7c4f 0%,
                #6d8f61 50%,
                #5a7c4f 100%);
            border-radius: 10px;
            box-shadow: inset -2px 0 5px rgba(0,0,0,0.3),
                        inset 2px 0 5px rgba(255,255,255,0.1);
        }

        .cactus-arm.left {
            height: 35px;
            left: -8px;
            top: 25px;
            transform: rotate(-20deg);
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }

        .cactus-arm.right {
            height: 30px;
            right: -8px;
            top: 35px;
            transform: rotate(25deg);
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }

        .cactus-needle {
            position: absolute;
            width: 2px;
            height: 4px;
            background: #3a4a2f;
        }

        .cactus-main .cactus-needle:nth-child(1) { left: 3px; top: 10px; }
        .cactus-main .cactus-needle:nth-child(2) { right: 3px; top: 15px; }
        .cactus-main .cactus-needle:nth-child(3) { left: 4px; top: 25px; }
        .cactus-main .cactus-needle:nth-child(4) { right: 4px; top: 30px; }
        .cactus-main .cactus-needle:nth-child(5) { left: 3px; top: 40px; }
        .cactus-main .cactus-needle:nth-child(6) { right: 3px; top: 45px; }
        .cactus-main .cactus-needle:nth-child(7) { left: 4px; top: 55px; }
        .cactus-main .cactus-needle:nth-child(8) { right: 4px; top: 60px; }

        .cactus-flower {
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 12px;
            background: radial-gradient(circle,
                #ff6b9d 0%,
                #ff4773 100%);
            border-radius: 50%;
            box-shadow: 0 0 5px rgba(255, 107, 157, 0.5);
        }

        .cactus-flower::before,
        .cactus-flower::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ff6b9d;
            border-radius: 50%;
        }

        .cactus-flower::before {
            top: -3px;
            left: -3px;
        }

        .cactus-flower::after {
            top: -3px;
            right: -3px;
        }

        #signal-display {
            font-size: 0.75em;
            color: #6b4423;
            font-weight: normal;
            font-family: 'Courier New', monospace;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            min-height: 100px;
            max-width: 95%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            line-height: 1.4;
            word-wrap: break-word;
            word-break: break-all;
            text-align: center;
            background: rgba(245, 230, 211, 0.3);
            border-radius: 10px;
            backdrop-filter: blur(2px);
        }

        #question {
            font-size: 1.3em;
            color: #5a4030;
            margin-bottom: 20px;
            font-style: italic;
        }

        input[type="text"] {
            width: 100%;
            max-width: 300px;
            padding: 15px;
            font-size: 1.1em;
            border: 2px solid #8b6f47;
            border-radius: 10px;
            background: #f5e6d3;
            color: #4a3728;
            margin-bottom: 20px;
            font-family: 'Georgia', serif;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #6b4423;
        }

        .level-indicator {
            font-size: 1.2em;
            color: #6b4423;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .warning {
            color: #c44536;
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Victory Screen Styles */
        #victory-screen {
            max-width: 100%;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        .smoke-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            z-index: 1;
        }

        .smoke-particle {
            position: absolute;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, 
                rgba(220, 210, 200, 0.15) 0%,
                rgba(200, 190, 180, 0.08) 50%,
                transparent 100%);
            border-radius: 50%;
            filter: blur(15px);
            animation: float-smoke 20s infinite ease-in-out;
        }

        .smoke-particle:nth-child(1) {
            left: 10%;
            animation-delay: 0s;
        }

        .smoke-particle:nth-child(2) {
            left: 30%;
            animation-delay: 5s;
        }

        .smoke-particle:nth-child(3) {
            left: 50%;
            animation-delay: 10s;
        }

        .smoke-particle:nth-child(4) {
            left: 70%;
            animation-delay: 15s;
        }

        @keyframes float-smoke {
            0% {
                bottom: -100px;
                opacity: 0;
                transform: translateX(0) scale(1);
            }
            10% {
                opacity: 0.3;
            }
            90% {
                opacity: 0.3;
            }
            100% {
                bottom: 100vh;
                opacity: 0;
                transform: translateX(50px) scale(1.5);
            }
        }

        .victory-content {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            height: 100vh;
            padding: 20px;
        }

        .victory-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .solutions-scroll {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            margin-bottom: 20px;
            background: rgba(245, 230, 211, 0.7);
            border-radius: 15px;
            backdrop-filter: blur(5px);
        }

        .solution-item {
            margin-bottom: 30px;
            opacity: 0;
            animation: scrollFadeIn 1s ease-out forwards;
        }

        .solution-item:nth-child(1) { animation-delay: 0.5s; }
        .solution-item:nth-child(2) { animation-delay: 1s; }
        .solution-item:nth-child(3) { animation-delay: 1.5s; }
        .solution-item:nth-child(4) { animation-delay: 2s; }
        .solution-item:nth-child(5) { animation-delay: 2.5s; }
        .solution-item:nth-child(6) { animation-delay: 3s; }
        .solution-item:nth-child(7) { animation-delay: 3.5s; }
        .solution-item:nth-child(8) { animation-delay: 4s; }
        .solution-item:nth-child(9) { animation-delay: 4.5s; }
        .solution-item:nth-child(10) { animation-delay: 5s; }

        @keyframes scrollFadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .solution-level {
            font-size: 1em;
            color: #8b6f47;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .solution-signal {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .solution-text {
            font-size: 1em;
            color: #5a4030;
            line-height: 1.5;
            font-style: italic;
        }

        .victory-buttons {
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Start Screen -->
        <div id="start-screen" class="screen active">
            <h1>Smoke Signals</h1>
            <p>Watch the signals rise from the fire. Decipher their meaning and answer the ancient question.</p>
            <p>Ten signals await. Can you read them all?</p>
            <button onclick="startGame()">Begin Journey</button>
        </div>

        <!-- Signal Animation Screen -->
        <div id="animation-screen" class="screen">
            <div class="level-indicator" id="level-display"></div>
            <div id="animation-container">
                <div class="scene">
                    <div class="eagle">
                        <div class="eagle-head">
                            <div class="eagle-beak"></div>
                        </div>
                        <div class="eagle-body"></div>
                        <div class="eagle-wing left"></div>
                        <div class="eagle-wing right"></div>
                    </div>
                    <div class="mountain"></div>
                    <div class="figure">
                        <div class="head"></div>
                        <div class="body"></div>
                        <div class="legs">
                            <div class="leg"></div>
                            <div class="leg"></div>
                        </div>
                    </div>
                    <div class="campfire">
                        <div class="fire">
                            <div class="flame"></div>
                            <div class="inner-flame"></div>
                            <div class="fire-glow"></div>
                        </div>
                        <div class="embers">
                            <div class="ember"></div>
                            <div class="ember"></div>
                            <div class="ember"></div>
                        </div>
                    </div>
                    <div class="cactus">
                        <div class="cactus-main">
                            <div class="cactus-needle"></div>
                            <div class="cactus-needle"></div>
                            <div class="cactus-needle"></div>
                            <div class="cactus-needle"></div>
                            <div class="cactus-needle"></div>
                            <div class="cactus-needle"></div>
                            <div class="cactus-needle"></div>
                            <div class="cactus-needle"></div>
                            <div class="cactus-flower"></div>
                        </div>
                        <div class="cactus-arm left"></div>
                        <div class="cactus-arm right"></div>
                    </div>
                </div>
            </div>
            <div id="signal-display"></div>
        </div>

        <!-- Question Screen -->
        <div id="question-screen" class="screen">
            <div class="level-indicator" id="level-display-question"></div>
            <div id="question">Haʼdę́ę́ʼ Act bibee níłtsą́ʼ nídééʼ?</div>
            <div id="warning-message" class="warning" style="display:none;"></div>
            <input type="text" id="answer-input" placeholder="Enter your answer...">
            <button onclick="submitAnswer()">Submit</button>
        </div>

        <!-- Game Over Screen -->
        <div id="gameover-screen" class="screen">
            <h2>Journey's End</h2>
            <p id="final-score"></p>
            <p>The signals remain a mystery for now.</p>
            <button onclick="restartGame()">Try Again</button>
        </div>

        <!-- Victory Screen -->
        <div id="victory-screen" class="screen">
            <div class="smoke-background">
                <div class="smoke-particle"></div>
                <div class="smoke-particle"></div>
                <div class="smoke-particle"></div>
                <div class="smoke-particle"></div>
            </div>
            <div class="victory-content">
                <div class="victory-header">
                    <h2>Wisdom Achieved!</h2>
                    <p>You have deciphered all ten smoke signals.</p>
                </div>
                <div class="solutions-scroll" id="solutions-container">
                    <!-- Solutions will be inserted here -->
                </div>
                <div class="victory-buttons">
                    <button onclick="restartGame()">Journey Again</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let gameData = [];
        let currentLevel = 0;
        let attempts = 2;
        let signalsData = [];

        async function loadGameData() {
            try {
                const response = await fetch('signals.json');
                signalsData = await response.json();
            } catch (error) {
                console.error('Error loading game data:', error);
                signalsData = [
                    { signal: "💨💨💨", act: "breath", solution: "In the first breath of morning, wisdom awakens.", level: 1 },
                    { signal: "🌊🌊🌊", act: "water", solution: "From the flowing waters, clarity is found.", level: 2 },
                    { signal: "🔥🔥🔥", act: "fire", solution: "Through the flames of trial, truth emerges.", level: 3 },
                    { signal: "🌙✨🌙", act: "dream", solution: "In the realm of dreams, the spirits speak.", level: 4 },
                    { signal: "🏔️⛰️🏔️", act: "climb", solution: "By climbing the sacred mountain, one sees beyond.", level: 5 },
                    { signal: "🌅🌄🌅", act: "dawn", solution: "At the breaking of dawn, new understanding rises.", level: 6 },
                    { signal: "🌲🌲🌲", act: "forest", solution: "Walking through the ancient forest, wisdom grows.", level: 7 },
                    { signal: "⚡💫⚡", act: "storm", solution: "In the heart of the storm, power is revealed.", level: 8 },
                    { signal: "🦅🦅🦅", act: "flight", solution: "With the eagle's flight, perspective is gained.", level: 9 },
                    { signal: "⭐🌟⭐", act: "star", solution: "Beneath the stars, the path becomes clear.", level: 10 }
                ];
            }
        }

        function startGame() {
            currentLevel = 0;
            attempts = 2;
            showScreen('animation-screen');
            
            // Set intro pattern for eagle
            const eagle = document.querySelector('.eagle');
            eagle.className = 'eagle fly-intro';
            
            showSignal();
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function showSignal() {
            const levelData = signalsData[currentLevel];
            document.getElementById('level-display').textContent = `Level ${currentLevel + 1} of 10`;
            document.getElementById('signal-display').textContent = levelData.signal;
            
            // Randomize eagle flight pattern for levels 2-10 (after intro)
            if (currentLevel > 0) {
                const eagle = document.querySelector('.eagle');
                const patterns = ['fly-right', 'fly-left', 'fly-circle', 'fly-zigzag', 'fly-dive', 'fly-swoop', 'fly-spiral', 'fly-wave', 'fly-figure8'];
                const randomPattern = patterns[Math.floor(Math.random() * patterns.length)];
                
                // Remove all previous pattern classes
                eagle.className = 'eagle';
                // Add new random pattern
                eagle.classList.add(randomPattern);
            }
            
            const container = document.querySelector('.scene');
            const smoke = document.createElement('div');
            smoke.className = 'smoke';
            
            for (let i = 0; i < 7; i++) {
                const puff = document.createElement('div');
                if (i < 5) {
                    puff.className = 'smoke-puff';
                } else {
                    puff.className = 'smoke-wisp';
                }
                smoke.appendChild(puff);
            }
            
            container.appendChild(smoke);

            setTimeout(() => {
                container.removeChild(smoke);
                showQuestionScreen();
            }, 3750);
        }

        function showQuestionScreen() {
            showScreen('question-screen');
            document.getElementById('level-display-question').textContent = `Level ${currentLevel + 1} of 10`;
            document.getElementById('answer-input').value = '';
            document.getElementById('warning-message').style.display = 'none';
            document.getElementById('answer-input').focus();
        }

        function submitAnswer() {
            const answer = document.getElementById('answer-input').value.trim().toLowerCase();
            const correctAnswer = signalsData[currentLevel].act.toLowerCase();

            if (answer === correctAnswer) {
                attempts = 2;
                currentLevel++;
                
                if (currentLevel >= signalsData.length) {
                    showVictoryScreen();
                } else {
                    showScreen('animation-screen');
                    showSignal();
                }
            } else {
                attempts--;
                if (attempts > 0) {
                    document.getElementById('warning-message').textContent = 'Incorrect. One chance remains.';
                    document.getElementById('warning-message').style.display = 'block';
                    document.getElementById('answer-input').value = '';
                } else {
                    document.getElementById('final-score').textContent = `You reached Level ${currentLevel + 1}`;
                    showScreen('gameover-screen');
                }
            }
        }

        function showVictoryScreen() {
            const container = document.getElementById('solutions-container');
            container.innerHTML = '';
            
            signalsData.forEach((data, index) => {
                const item = document.createElement('div');
                item.className = 'solution-item';
                item.innerHTML = `
                    <div class="solution-level">Level ${data.level}</div>
                    <div class="solution-signal">${data.signal}</div>
                    <div class="solution-text">${data.solution}</div>
                `;
                container.appendChild(item);
            });
            
            showScreen('victory-screen');
        }

        function restartGame() {
            currentLevel = 0;
            attempts = 2;
            showScreen('start-screen');
        }

        document.getElementById('answer-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                submitAnswer();
            }
        });

        loadGameData();
    </script>
</body>
</html>
